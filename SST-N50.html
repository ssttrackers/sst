<style>
  th, td {
    border: 1px solid #ddd;
    padding: 8px; /* pehle 10px tha, ab 8px kiya to row height tight ho jayegi */
    text-align: center;
    font-size: 14px;
  }

  tr:hover td {
    background-color: #f9f9f9;
  }

  /* Stock rows ki height thodi kam karne ke liye */
  table tr:nth-child(n+5) td {
    padding: 6px 8px;  /* sirf data rows me height kam ki */
  }
</style>

<script>
  const colIndexes = {
    ticker: headerRow.findIndex(h => h === 'TICKER'),
    todayChange: headerRow.findIndex(h => h.includes('TODAY CHANGE')),
    percentDiff: headerRow.findIndex(h => h.includes('% DIFF')),
    gttUpdate: headerRow.findIndex(h => h.includes('GTT UPDATE')),
    pnl: headerRow.findIndex(h => h.includes('P&L'))
  };

  rows.forEach((row, i) => {
    const tr = document.createElement('tr');

    row.forEach((col, j) => {
      const content = col.trim();
      const cell = document.createElement(i <= headerRowIndex ? 'th' : 'td');

      // Ticker hyperlink
      if (i > headerRowIndex && j === colIndexes.ticker && content !== '') {
        const link = document.createElement('a');
        link.href = `https://www.tradingview.com/chart/?symbol=NSE:${content}`;
        link.target = "_blank";
        link.textContent = content;
        link.style.fontWeight = 'bold';
        cell.appendChild(link);
        tr.appendChild(cell);
        return;
      }

      // TODAY CHANGE aur P&L% ko color karo
      if (i > headerRowIndex && [colIndexes.todayChange, colIndexes.pnl].includes(j)) {
        const num = parseFloat(content);
        if (!isNaN(num)) {
          cell.style.fontWeight = "bold";
          cell.style.color = num > 0 ? "green" : (num < 0 ? "red" : "black");
        }
      }

      // % DIFF ko sirf bold black me rakho
      if (i > headerRowIndex && j === colIndexes.percentDiff) {
        cell.style.fontWeight = "bold";
        cell.style.color = "black";
      }

      // GTT UPDATE styling
      if (i > headerRowIndex && j === colIndexes.gttUpdate) {
        const val = content.toUpperCase();
        if (val === "TRIGGERED") {
          cell.style.backgroundColor = "#28a745";
          cell.style.color = "white";
          cell.style.fontWeight = "bold";
        } else if (val === "YES") {
          cell.style.backgroundColor = "#ffc107";
          cell.style.color = "black";
          cell.style.fontWeight = "bold";
        } else if (val === "NEW ADD") {
          cell.style.backgroundColor = "#007bff";
          cell.style.color = "white";
          cell.style.fontWeight = "bold";
        }
      }

      // Default text
      if (cell.childNodes.length === 0) {
        cell.textContent = content;
      }

      tr.appendChild(cell);
    });

    table.appendChild(tr);
  });
</script>
