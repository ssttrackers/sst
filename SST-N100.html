<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SST N100 Report</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #f9f9f9;
    }
    h1 {
      color: #333;
    }
    a {
      text-decoration: none;
      color: #0066cc;
      display: inline-block;
      margin-bottom: 20px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background-color: #fff;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: center;
    }
    th {
      background-color: #efefef;
    }
    tr.data-row td {
      padding: 6px; /* reduce height */
    }
  </style>
</head>
<body>

  <h1>üìä SST N100 Report</h1>
  <a href="index.html">‚¨ÖÔ∏è Back to Home</a>
  <table id="csvTable"></table>

  <script>
    const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQJoID6vuDnZN4q_-6Jj4MiG2yvF3u573bwPXbrfK2zW1WnIDfVVobFYOVDQydWH85eEHflBq2SMtlE/pub?gid=1687377945&single=true&output=csv';

    fetch(sheetUrl)
      .then(res => res.text())
      .then(csv => {
        const rows = csv.trim().split('\n');
        const table = document.getElementById('csvTable');

        let headerCols = [];
        let dataStarted = false;

        rows.forEach((row, i) => {
          const cols = row.split(',');
          const tr = document.createElement('tr');

          if (!dataStarted) {
            // Check for actual data header
            if (cols.includes('Ticker')) {
              headerCols = cols.map(col => col.trim().toUpperCase());
              dataStarted = true;
            }

            cols.forEach(col => {
              const th = document.createElement('th');
              th.textContent = col.trim();
              tr.appendChild(th);
            });
          } else {
            tr.classList.add('data-row');
            cols.forEach((col, j) => {
              const td = document.createElement('td');
              const content = col.trim();
              const colName = headerCols[j];

              // Hyperlink for Ticker column
              if (colName === 'TICKER' && content !== '') {
                const link = document.createElement('a');
                link.href = `https://www.tradingview.com/chart/?symbol=NSE:${content}`;
                link.target = "_blank";
                link.textContent = content;
                td.appendChild(link);
              } else {
                td.textContent = content;
              }

              // % DIFF column ‚Üí bold black
              if (colName === '% DIFF') {
                td.style.fontWeight = 'bold';
                td.style.color = 'black';
              }

              // P&L % ‚Üí red/green
              if (colName === 'P&L %') {
                const num = parseFloat(content);
                if (!isNaN(num)) {
                  td.style.fontWeight = 'bold';
                  td.style.color = num > 0 ? 'green' : (num < 0 ? 'red' : 'black');
                }
              }

              // GTT UPDATE ‚Üí color code
              if (colName === 'GTT UPDATE') {
                const val = content.toUpperCase();
                td.style.fontWeight = 'bold';
                if (val === 'TRIGGERED') {
                  td.style.backgroundColor = '#28a745';
                  td.style.color = 'white';
                } else if (val === 'YES') {
                  td.style.backgroundColor = '#ffc107';
                  td.style.color = 'black';
                } else if (val === 'NEW ADD') {
                  td.style.backgroundColor = '#007bff';
                  td.style.color = 'white';
                }
              }

              tr.appendChild(td);
            });
          }

          table.appendChild(tr);
        });
      });
  </script>

</body>
</html>
